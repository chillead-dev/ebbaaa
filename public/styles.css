:root{
  /* Apple flat palette */
  --accent:#007AFF;
  --ok:#34C759;
  --danger:#FF3B30;
  --bg:#0A0A0C;
  --bg2:#000000;

  --text:#FFFFFF;
  --muted:#8E8E93;

  /* glass */
  --glass: rgba(255,255,255,0.03);
  --glass2: rgba(255,255,255,0.05);
  --stroke: rgba(255,255,255,0.10);
  --stroke2: rgba(255,255,255,0.08);

  --shadow: 0 18px 50px rgba(0,0,0,.55);
  --shadowSoft: 0 12px 30px rgba(0,0,0,.28);

  --rXL:22px;
  --rL:18px;
  --rM:16px;
  --rS:14px;

  --pad: 14px;
  --pad2: 18px;

  --ease: cubic-bezier(.2,.8,.2,1);
  --tap: scale(.985);
}

html[data-theme="light"]{
  --accent:#007AFF;
  --ok:#34C759;
  --danger:#FF3B30;

  --bg:#F2F2F7;
  --bg2:#FFFFFF;

  --text:#0A0A0C;
  --muted:#6B7280;

  --glass: rgba(255,255,255,0.72);
  --glass2: rgba(255,255,255,0.86);
  --stroke: rgba(10,10,12,0.10);
  --stroke2: rgba(10,10,12,0.08);

  --shadow: 0 18px 45px rgba(10,10,12,.10);
  --shadowSoft: 0 12px 28px rgba(10,10,12,.08);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background: radial-gradient(1200px 700px at 20% 0%, rgba(0,122,255,.08), transparent 60%),
              radial-gradient(900px 600px at 80% 10%, rgba(52,199,89,.06), transparent 60%),
              var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display","Segoe UI",Roboto,Helvetica,Arial;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
  overscroll-behavior: none;
}
html[data-theme="dark"] body{
  /* keep monochrome background, no gradients as requested */
  background: var(--bg);
}
img{display:block}
.hidden{display:none!important}
.app{max-width:920px;margin:0 auto}

/* ===== Scrollbar (thin) ===== */
*{
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,.18) transparent;
}
*::-webkit-scrollbar{width:8px;height:8px}
*::-webkit-scrollbar-track{background:transparent}
*::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,.16);
  border: 2px solid transparent;
  background-clip: padding-box;
  border-radius: 999px;
}
html[data-theme="light"] *::-webkit-scrollbar-thumb{background: rgba(10,10,12,.20)}
*::-webkit-scrollbar-thumb:hover{background: rgba(255,255,255,.24)}

/* ===== Glass containers ===== */
.glass{
  background: var(--glass);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 0.5px solid var(--stroke);
  box-shadow: var(--shadowSoft);
}

/* ===== Topbars ===== */
.topbarShell{
  position:sticky;top:0;z-index:50;
  background: color-mix(in srgb, var(--bg) 80%, transparent);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
}
.topbar{
  height:62px;
  display:flex;align-items:center;justify-content:space-between;
  padding: 0 var(--pad);
  gap:12px;
}
.brandMini{display:flex;align-items:center;gap:12px;min-width:180px}
.brandIcon{width:34px;height:34px;border-radius:12px}
.brandTitle{font-weight:900;letter-spacing:-.02em}
.brandSub{color:var(--muted);font-size:12px;margin-top:3px}

.pillBtn{
  border: 0.5px solid var(--stroke);
  background: var(--glass);
  color: var(--text);
  border-radius: 999px;
  padding: 10px 13px;
  display:flex;align-items:center;gap:10px;
  cursor:pointer;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  transition: transform .12s var(--ease), border-color .16s var(--ease), background .16s var(--ease);
}
.pillBtn:hover{border-color: color-mix(in srgb,var(--accent) 32%, var(--stroke))}
.pillBtn:active{transform:var(--tap)}
.pillDot{
  width:10px;height:10px;border-radius:999px;background:var(--accent);
  box-shadow:0 0 0 5px color-mix(in srgb,var(--accent) 16%,transparent);
}

/* ===== Screens ===== */
.screen{
  min-height:calc(100vh - 62px);
  display:flex;align-items:center;justify-content:center;
  padding: 22px 14px;
}
.screenMain{min-height:calc(100vh - 62px);padding:0;display:flex}
.shell{width:100%;display:flex;flex-direction:column;min-height:calc(100vh - 62px)}

/* ===== Auth ===== */
.authCard{
  width:min(520px,94vw);
  padding: 20px;
  border-radius: var(--rXL);
  background: var(--glass);
  border: 0.5px solid var(--stroke);
  backdrop-filter: blur(22px);
  -webkit-backdrop-filter: blur(22px);
  box-shadow: var(--shadow);
}
.authHeader{display:flex;align-items:center;gap:14px;padding:6px 2px 16px}
.authLogo{
  width:54px;height:54px;border-radius:18px;
  display:flex;align-items:center;justify-content:center;
  background: var(--glass2);
  border: 0.5px solid var(--stroke2);
}
.authLogo img{width:30px;height:30px}
.authTitle{font-weight:950;font-size:18px;letter-spacing:-.03em}
.authHint{color:var(--muted);font-size:12px;margin-top:4px}

.seg{
  display:flex;gap:8px;
  padding: 6px;
  border-radius: 999px;
  background: var(--glass2);
  border: 0.5px solid var(--stroke2);
  margin: 10px 0 18px;
}
.segBtn{
  flex:1;
  border:0;
  background:transparent;
  color: var(--muted);
  padding: 11px 12px;
  border-radius: 999px;
  font-weight: 900;
  cursor:pointer;
  transition: background .16s var(--ease), color .16s var(--ease), transform .12s var(--ease);
}
.segBtn:active{transform:var(--tap)}
.segBtn.isOn{
  color: var(--text);
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  box-shadow: var(--shadowSoft);
}

.form{display:flex;flex-direction:column;gap:14px}
.field{display:block}
.lbl{font-size:12px;color:var(--muted);margin:0 0 7px 2px}
.input{
  width:100%;
  padding: 13px 13px;
  border-radius: var(--rM);
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.03);
  color: var(--text);
  outline:none;
  font-size:14px;
  transition: border-color .16s var(--ease), box-shadow .16s var(--ease), background .16s var(--ease);
}
html[data-theme="light"] .input{background: rgba(10,10,12,0.03)}
.input:focus{
  border-color: color-mix(in srgb,var(--accent) 40%, var(--stroke2));
  box-shadow: 0 0 0 6px color-mix(in srgb,var(--accent) 16%, transparent);
}
.input.code{letter-spacing:.4em;text-align:center;font-weight:950}

.pwWrap{position:relative}
.pwWrap .input{padding-right:54px}
.iconSquare{
  position:absolute;right:8px;top:50%;transform:translateY(-50%);
  width:42px;height:42px;border-radius: 14px;
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.04);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  transition: transform .12s var(--ease), border-color .16s var(--ease), background .16s var(--ease);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
}
.iconSquare:hover{border-color: color-mix(in srgb,var(--accent) 28%, var(--stroke2))}
.iconSquare:active{transform:translateY(-50%) var(--tap)}
.iconSquare img{width:18px;height:18px;opacity:.92}

.btn{
  border-radius: 999px;
  padding: 13px 14px;
  border: 0.5px solid var(--stroke);
  background: rgba(255,255,255,0.05);
  color: var(--text);
  font-weight: 950;
  cursor:pointer;
  transition: transform .12s var(--ease), border-color .16s var(--ease), background .16s var(--ease);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
.btn:hover{border-color: color-mix(in srgb,var(--accent) 30%, var(--stroke))}
.btn:active{transform:var(--tap)}
.btn.primary{
  border-color: color-mix(in srgb,var(--accent) 45%, var(--stroke));
  background: rgba(0,122,255,0.14);
}
.btn.danger{
  border-color: color-mix(in srgb,var(--danger) 45%, var(--stroke));
  background: rgba(255,59,48,0.14);
}
.btn.ghost{background:transparent}

.note{color:var(--muted);font-size:12px;line-height:1.4;padding: 2px 2px 0}
.status{margin-top:12px;min-height:18px;color:var(--muted);font-size:12px;white-space:pre-wrap}

/* ===== Main topbar ===== */
.topbar2{
  height:62px;
  display:flex;align-items:center;gap:12px;
  padding: 12px var(--pad);
  background: color-mix(in srgb, var(--bg) 88%, transparent);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  position:sticky;top:62px;z-index:40;
}
.topTitle{font-weight:950;letter-spacing:-.02em;font-size:18px;min-width:64px}
.searchWrap{flex:1}
.search{
  width:100%;
  padding: 12px 14px;
  border-radius: 999px;
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.03);
  color:var(--text);
  outline:none;
}
.search:focus{
  border-color: color-mix(in srgb,var(--accent) 40%, var(--stroke2));
  box-shadow: 0 0 0 6px color-mix(in srgb,var(--accent) 16%, transparent);
}
.iconBtn{
  width:44px;height:44px;border-radius:999px;
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.04);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  transition: transform .12s var(--ease), border-color .16s var(--ease);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
.iconBtn:active{transform:var(--tap)}
.iconBtn img{width:18px;height:18px;opacity:.92}

/* ===== Views ===== */
.content{flex:1;overflow:auto}
.view{min-height:100%}

.list{padding: 10px 0 calc(88px + env(safe-area-inset-bottom))}
.row{
  display:flex;align-items:center;gap:14px;
  padding: 12px 14px;
  cursor:pointer;
  border-radius: 18px;
  margin: 6px 10px;
  background: rgba(255,255,255,0.02);
  transition: background .16s var(--ease), transform .12s var(--ease);
}
.row:hover{background: rgba(255,255,255,0.04)}
.row:active{transform:var(--tap)}

.avatar{
  width:54px;height:54px;border-radius:999px;
  background: rgba(255,255,255,0.04);
  border: 0.5px solid var(--stroke2);
  overflow:hidden;
  display:flex;align-items:center;justify-content:center;
  flex:0 0 auto;
}
.avatar img{width:100%;height:100%;object-fit:cover}
.avatar .ph{font-weight:950;color:var(--accent)}

.mid{flex:1;min-width:0}
.title{font-weight:950;letter-spacing:-.01em;display:flex;align-items:center;gap:8px}
.sub{margin-top:3px;font-size:13px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.right{text-align:right;display:flex;flex-direction:column;align-items:flex-end;gap:8px}
.time{color:var(--muted);font-size:12px}
.badge{
  min-width:22px;height:22px;border-radius:999px;padding:0 7px;
  background: var(--accent);
  color:#fff;font-weight:950;font-size:12px;
  display:flex;align-items:center;justify-content:center;
}

/* verify badge */
.vbadge{
  display:inline-flex;align-items:center;justify-content:center;
  width:16px;height:16px;border-radius:999px;
  background: rgba(0,122,255,.20);
  border: 0.5px solid rgba(0,122,255,.45);
}
.vbadge svg{width:12px;height:12px;color: var(--accent)}

/* ===== Messages ===== */
.msgShell{height:100%;display:flex;flex-direction:column}
.msgHeader{
  padding: 12px 14px;
  background: color-mix(in srgb, var(--bg) 88%, transparent);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border-bottom: 0.5px solid var(--stroke2);
  display:flex;align-items:center;gap:12px;
  position:sticky;top:0;z-index:30;
}
.backBtn{
  width:44px;height:44px;border-radius:999px;
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.04);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
.backBtn img{width:18px;height:18px;opacity:.92}
.msgHeaderTitle{font-weight:950;display:flex;flex-direction:column;line-height:1.1}
.msgHeaderTitle .nameLine{display:flex;align-items:center;gap:8px}
.msgHeaderTitle .statusLine{color:var(--muted);font-size:12px;margin-top:4px}

.msgList{
  flex:1;overflow:auto;
  padding: 18px 14px calc(108px + env(safe-area-inset-bottom));
  background: transparent;
}

.chatBg{
  background-image: var(--chat-wallpaper, none);
  background-size: cover;
  background-position: center;
}

.pinBar{
  margin: 10px 10px 0;
  padding: 10px 12px;
  border-radius: 16px;
  background: var(--glass);
  border: 0.5px solid var(--stroke2);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  display:flex;align-items:center;justify-content:space-between;
  gap:12px;
}
.pinBar .pinText{color:var(--muted);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pinBar .pinBtn{border:0;background:transparent;color:var(--text);font-weight:900;cursor:pointer}

.bubble{
  max-width:min(560px,86%);
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.05);
  border-radius: 18px;
  padding: 10px 12px;
  margin: 10px 0;
  line-height:1.38;
  box-shadow: var(--shadowSoft);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
}
.bubble.me{
  margin-left:auto;
  border-color: rgba(0,122,255,.35);
  background: rgba(0,122,255,.14);
}
.msgMeta{
  margin-top:7px;
  color:var(--muted);
  font-size:11px;
  display:flex;align-items:center;justify-content:flex-end;gap:6px;
}
.checks{opacity:.9}

.composer{
  position:sticky;
  bottom:calc(72px + env(safe-area-inset-bottom));
  padding: 10px 12px;
  background: color-mix(in srgb, var(--bg) 88%, transparent);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
}
.composerRow{
  display:flex;gap:10px;align-items:center;
  background: rgba(255,255,255,0.04);
  border: 0.5px solid var(--stroke2);
  border-radius: 999px;
  padding: 9px 10px;
}
.msgInput{
  flex:1;border:0;outline:none;background:transparent;color:var(--text);
  font-size:15px;
  font-family: inherit;
}
.sendBtn{
  width:44px;height:44px;border-radius:999px;
  border: 0.5px solid rgba(0,122,255,.45);
  background: rgba(0,122,255,.14);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
}
.sendBtn img{width:18px;height:18px;opacity:.95}

/* ===== Tabbar ===== */
.tabbar{
  height:72px;
  padding: 10px 10px calc(10px + env(safe-area-inset-bottom));
  background: color-mix(in srgb, var(--bg) 86%, transparent);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  display:flex;gap:8px;
  position:sticky;bottom:0;z-index:45;
}
.tab{
  flex:1;border:0;background:transparent;color:var(--muted);
  border-radius: 18px;
  padding: 8px 6px;
  cursor:pointer;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:5px;
  transition: background .16s var(--ease), color .16s var(--ease), transform .12s var(--ease);
}
.tab:active{transform:var(--tap)}
.tab img{width:20px;height:20px;opacity:.92}
.tab .lbl{font-size:11px;font-weight:900}
.tab.isOn{background: rgba(255,255,255,0.06);color: var(--text)}

/* ===== Panels ===== */
.pad{padding: 14px}
.panel{
  background: var(--glass);
  border: 0.5px solid var(--stroke2);
  border-radius: 20px;
  padding: 14px;
  margin-bottom: 14px;
  box-shadow: var(--shadowSoft);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
.panelTitle{font-weight:950;margin-bottom:12px}
.grid{display:grid;grid-template-columns:1fr;gap:12px}

.switchRow{
  display:flex;justify-content:space-between;align-items:center;gap:12px;
  padding: 12px;
  border-radius: 18px;
  background: rgba(255,255,255,0.04);
  border: 0.5px solid var(--stroke2);
}
.smallBtn{
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.04);
  color: var(--text);
  border-radius: 999px;
  padding: 10px 13px;
  font-weight: 950;
  cursor:pointer;
}

/* ===== Toast ===== */
.toastHost{
  position:fixed;left:0;right:0;
  bottom:calc(86px + env(safe-area-inset-bottom));
  display:flex;justify-content:center;
  pointer-events:none;
  padding:0 12px;
  z-index:999;
}
.toast{
  pointer-events:none;
  max-width:680px;
  border-radius:999px;
  padding: 11px 13px;
  background: rgba(255,255,255,0.06);
  border: 0.5px solid var(--stroke2);
  color: var(--text);
  box-shadow: var(--shadowSoft);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  font-weight:950;font-size:13px;
  opacity:0;transform:translateY(10px);
  transition: opacity .18s var(--ease), transform .18s var(--ease);
}
.toast.show{opacity:1;transform:translateY(0)}

/* ===== Modal ===== */
.modalOverlay{
  position:fixed;inset:0;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  display:flex;align-items:center;justify-content:center;
  padding: 18px;
  z-index: 1000;
}
.modal{
  width:min(520px, 96vw);
  border-radius: 22px;
  background: var(--glass);
  border: 0.5px solid var(--stroke);
  backdrop-filter: blur(22px);
  -webkit-backdrop-filter: blur(22px);
  box-shadow: var(--shadow);
  padding: 16px;
}
.modalHeader{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px}
.modalTitle{font-weight:950}
.modalClose{
  width:44px;height:44px;border-radius:999px;
  border: 0.5px solid var(--stroke2);
  background: rgba(255,255,255,0.04);
  cursor:pointer;
}

/* ===== Skeleton ===== */
.skel{
  position:relative;
  overflow:hidden;
  background: rgba(255,255,255,0.04);
  border: 0.5px solid var(--stroke2);
}
.skel::after{
  content:"";
  position:absolute;inset:-40%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.10), transparent);
  transform: translateX(-60%);
  animation: skel 1.3s infinite;
}
@keyframes skel { to { transform: translateX(60%); } }

/* ===== Responsive ===== */
@media (min-width:760px){ .app{max-width:600px} }
@media (max-width:380px){
  .topTitle{min-width:52px;font-size:17px}
  .row{margin:6px 8px;padding:11px 12px}
  .avatar{width:50px;height:50px}
}
